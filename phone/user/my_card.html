<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="description" content="" />
        <meta name="keywords" content="" />
        <meta name="author" content="Flying hormone" />
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
        <meta name="renderer" content="webkit">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta charset="UTF-8">
        <link rel="stylesheet" href="../css/mui.min.css" />
        <script type="text/javascript" src="../js/jquery-1.9.1.js"></script>
        <script type="text/javascript" src="../js/jquery.Query.js" ></script>
        <script type="text/javascript" src="../js/jquery-cookie.js"></script>
        <script type="text/javascript" src="../js/mui.min.js"></script>
        <script type="text/javascript" src="../js/appcan.js"></script>
        <script type="text/javascript" src="../js/appcan.control.js"></script>
        <script type="text/javascript" src="../js/common.js" ></script>
		<title>我的名片</title>
		<style>
            * {
                margin: 0;
                padding: 0;
                box-sizing: border-box;
                -moz-box-sizing: border-box;
                -webkit-box-sizing: border-box;
            }
            
            body {
                width: 100%;
                overflow-x: hidden;
                font-family: "微软雅黑";
                background: #f8f8f8;
                font-size: 1em;
                padding-bottom: 3.875em;
            }
            
            h1,
            h2,
            h3,
            h4,
            h5,
            h6 {
                font-weight: normal;
                margin: 0;
            }
            
            p {
                margin: 0;
                font-size: 0.8em;
            }
            
            header {
                background: #ff3366;
                height: 3em;
                overflow: hidden;
                position: relative;
            }
            
            header h1 {
                font-size: 1.5em;
                text-align: center;
                color: #fff;
                line-height: 2em;
                font-weight: normal;
                margin: 0;
            }
            
            header a {
                position: absolute;
                height: 100%;
            }
            
            header a img {
                height: 2em;
            }
            
            .dingwei img {
                position: absolute;
                top: 1em;
                left: 0.3125em;
            }
            
            .dingwei span {
                display: block;
                line-height: 1.5em;
                font-size: 2em;
                color: #fff;
            }
            
            
            footer nav a{
                    display: table-cell;
                    overflow: hidden;
                    width: 1%;
                    height: 3.125em;
                    text-align: center;
                    vertical-align: middle;
                    white-space: nowrap;
                    text-overflow: ellipsis;
                    color: #929292;
            }
            
            footer nav a img {
                width: 15%;
                display: block;
                margin: 0 auto;
                margin-top: 0.3125em;
                margin-bottom: 0.1em;
            }
            
            footer nav span {
                color: #020202;
            }
            
            footer nav .action span {
                color: #ff3366;
            }
            
            .yiyou{ height: 2.5em; line-height: 2.5em; position: relative; background: #fff; margin: 0.3125em 0;}
            .yiyou h3{ height: 2.5em; line-height: 2.5em;  font-size: 1em; text-indent: 1em;}
            .yiyou p{ position: absolute; top: 0; right: 0; line-height: 2.5em;}
            .yiyou p a{ color: #999; border: 1px solid #ddd; padding: 0.125em 0.625em; border-radius: 0.25em; margin-right: 0.3125em;}
            .card_list li{ height: 5em; background: #fff; margin-bottom: 0.3125em; position: relative;}
            .card_list img{ width: 3.125em; margin-top: 1em; margin-left: 0.625em;}
            .card_list p{ position: absolute; left: 5.625em; top: 0; line-height: 5em; color: #333; font-size: 1em;}
            .card_list span{ display: none; position: absolute; top: 1em; right: 0.625em; font-size: 2.5em; color: #0070c5;}
        </style>
	</head>

	<body>
		<header>
			<a class="dingwei"><span class="mui-icon mui-icon-back"></span></a>
			<h1>我的名片</h1>
		</header>
		<section class="yiyou">
			<h3>已有名片</h3>
			<p><a id="del" href="javascript:;">删除</a><a id="edit" href="javascript:;">编辑</a><a href="add_card.html">添加</a></p>
		</section>
		<section class="card_list">
			<ul id="cardList">
			</ul>
		</section>

		<footer>
			<nav class="mui-bar mui-bar-tab">
				<a class="action" href="javascript:;" id="tcIndex">
                    <img src="../img/shouye.png" />
                    <span class="mui-tab-label">首页</span>
                </a>
                <a href="javascript:;" id="myfabu">
                    <img src="../img/fabu2.png" />
                    <span class="mui-tab-label">发布</span>
                </a>
                <a href="javascript:;" id="myInfo">
                    <img src="../img/mine.png" />
                    <span class="mui-tab-label">我的</span>
                </a>
			</nav>
		</footer>
		<script>
			$(document).ready(function(){
			     var isChangeId = "";
			    //添加
    		    appcan.ajax({
                    type:"post",
                    async:false,       
                    url:host+"/getCardList.json?userId=1",
                    data:"",
                    dataType:"json",
                    contentType: "application/json",
                    success : function(dataResult) {
                        var dataList = dataResult.data;
                        var cardStr = "";
                        if(dataList.length>0){
                            for(var i=0;i<dataList.length;i++){
                                cardStr +='<li data-id="'+dataList[i].id+'">';
                                cardStr +='<img src="'+hostIp+dataList[i].picUrl+'" />';
                                cardStr +='<p>'+dataList[i].cardName+'</p>';
                                cardStr +='<span class="mui-icon mui-icon-checkmarkempty"></span>';
                                cardStr +=' </li>';
                            }
                        }
                        $("#cardList").html(cardStr);
                        
                        $(".card_list li").click(function(){
                            if( $(this).find("span").css("display") == "block"){
                                $(this).find("span").hide();
                                isChangeId = "";
                            }else{
                                $(this).find("span").show();
                                isChangeId = $(this).attr("data-id");
                            }
                        });
                    }
                }) 
                //删除
                $("#del").click(function(){
                    if(isChangeId!="" && confirm('你确定要删除?')){
                        //名片删除
                        appcan.ajax({
                           type:"post",
                           async:false,       
                           url:host+"/delCard.json?cardId="+isChangeId,
                           data:"",
                           dataType:"json",
                           contentType: "application/json",
                           success : function(dataResult) {
                               if(dataResult.msg=='success'){
                                   alert("删除成功！");
                                   window.location.reload();
                               }
                           }
                       })
                   }
                })
                //编辑
                $("#edit").click(function(){
                    if(isChangeId!=""){
                        window.location.href = "add_card.html?cardId="+isChangeId;
                    }
                })
			});
		</script>
	</body>

</html>